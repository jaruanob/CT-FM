  train_dataset:
    _target_: project.datasets.idc_ssl.IDCDataset
    root_dir: /mnt/data1/IDC_ibro_nrrd/
    transform:
      _target_: torchvision.transforms.Compose
      transforms:
        # - _target_: lighter.transforms.SitkRandomSpacing
        #   prob: 0.25
        #   min_spacing: [0.4, 0.4, 2]
        #   max_spacing: [1, 1, 3]
        #   tolerance: null
        #   default_value: -1024
        #   interpolator: "linear"


        - _target_: lighter.transforms.SitkToTensor
          add_channel_dim: True
        - # Scale from -1024 to 3072 to 0-1 and clip outside values
          _target_: monai.transforms.ScaleIntensityRange
          a_min: -1024
          a_max: 3072
          b_min: 0
          b_max: 1
          clip: True

        # - Add a crop slightly bigger than 
        
        - _target_: lighter.transforms.MultiCrop
          high_resolution_transforms:
            - _target_: torchvision.transforms.Compose
              transforms:
                - _target_: monai.transforms.RandSpatialCrop
                  roi_size: ${CONSTANTS.HIGH_RES_SIZE}
                  random_size: False
                - _target_: monai.transforms.RandFlip
                  prob: 0.25
                  spatial_axis: 2
                - # RandHistogramShift serves purpose similar to color jitter
                  # by modifying the intensity histogram
                  _target_: monai.transforms.RandHistogramShift
                  prob: 0.5
                - # RandGaussianSmooth is similar to SimCLR GaussianBlur
                  _target_: monai.transforms.RandGaussianSmooth
                  prob: 0.5
                - _target_: monai.transforms.SpatialPad
                  spatial_size: ${CONSTANTS.HIGH_RES_SIZE}
            - ${.[0]}
          low_resolution_transforms:
            - _target_: torchvision.transforms.Compose
              transforms:
                - _target_: monai.transforms.RandSpatialCrop
                  roi_size: [8, 64, 64]
                  max_roi_size: ${CONSTANTS.LOW_RES_SIZE}
                  random_size: True
                - _target_: monai.transforms.RandFlip
                  prob: 0.25
                  spatial_axis: 2
                - # RandHistogramShift serves purpose similar to color jitter
                  # by modifying the intensity histogram
                  _target_: monai.transforms.RandHistogramShift
                  prob: 0.5
                - # RandGaussianSmooth is similar to SimCLR GaussianBlur
                  _target_: monai.transforms.RandGaussianSmooth
                  prob: 0.25
                - _target_: monai.transforms.SpatialPad
                  spatial_size: ${CONSTANTS.LOW_RES_SIZE}
            - ${.[0]}
            - ${.[0]}
            - ${.[0]}